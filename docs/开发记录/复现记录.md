# Flux4D 复现记录

## 记录说明

- 参考 `docs/开发记录/复现计划.md` 执行，按阶段记录每次实际动作与结果。
- 调试阶段在 24G 5090 上保持论文视图数与分辨率，仅缩小 batch/启用梯度累积。

## 环境与目标

- 数据集：PandaSet（`/home/yr/yr/data/automonous/pandaset`）。
- 参考仓库：GaussianSTORM（`/home/yr/yr/code/cv/AutoLabel/SSL/GaussianSTORM_all/GaussianSTORM`，环境 `storm`）。
- 目标：复现 PSNR/SSIM/Depth RMSE/Flow EPE，并产出可视化结果。

## 进度总览

- 阶段0：环境与基线验证（已完成）
- 阶段1：数据索引与切片（已完成）
- 阶段2：Lift 初始化（未开始）
- 阶段3：Flux4D-base 预测器（未开始）
- 阶段4：时间推进与光流渲染（未开始）
- 阶段5：Flux4D 增强（未开始）
- 阶段6：全量训练与评测（未开始）

## 2026-01-27

### 已完成

- 创建顶层目录结构：`configs/`、`data/`、`src/flux4d/`、`scripts/`、`tools/vis/`、`tests/`、`assets/`、`third_party/`。
- 明确调试策略：保持论文视图数与分辨率，仅通过 batch 与梯度累积控制显存。
- 核对 PandaSet 时间同步与标定文件（样例：`001`）：`meta` 与 `lidar` timestamps 对齐，各相机 timestamps 与 lidar 长度一致且存在固定 offset；`intrinsics.json` 与 `poses.json` 完整。
- 在 `gaussianstorm` 环境复跑 GaussianSTORM demo，推理日志与视频输出正常（`work_dirs/inference_test/ckpt_099999_sky_affine/logs/log.txt` 与 `work_dirs/inference_test_outputs_sky_affine/test_*.mp4`）。
- 生成 PandaSet clip 索引：`data/metadata/pandaset_full_clips.pkl`（515 条）与
  `data/metadata/pandaset_tiny_clips.pkl`（10 条，默认场景 `001/002`，10Hz，1.5s/stride 1.5s）。
- 补充数据说明文档：`docs/数据处理与说明/数据处理与说明.md`。
- 按编码规范补齐中文 Docstring 与类型标注，新增 PKL 检查脚本 `scripts/inspect_pkl.py`。

### 待办

- 阶段2：实现 LiDAR → 高斯（Lift）并建立可视化门禁。

### 问题与阻塞

- 暂无。
